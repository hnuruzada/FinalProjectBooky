@inject FinalProjectBooky.Services.LayoutService layoutService
@{
    BasketVM basket = await layoutService.ShowBasket();

}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- font awesome cdn link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet"
          href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <!-- Owl carousel min css -->
    <link rel="stylesheet" href="~/Assets/owl.carousel.min.css">
    <link rel="stylesheet" href="~/Assets/owl.theme.default.min.css">
    @RenderSection("CSS",required:false)
    <!-- custom css file link  -->
    <link rel="stylesheet" href="~/Assets/style/style.css">
    <title>Home Page</title>

</head>

<body>

    <!-- header section starts  -->

    <header class="header">

        <div class="header-1">

            <a asp-controller="home" asp-action="index" class="logos">
                <svg class="book-shelf" xmlns="http://www.w3.org/2000/svg"
                     preserveAspectRatio="xMidYMid" viewBox="0 0 84 94" height="94" width="84">
                    <path fill="none"
                          d="M37.612 92.805L4.487 73.71c-2.75-1.587-4.45-4.52-4.45-7.687L.008 27.877c-.003-3.154 1.676-6.063 4.405-7.634L37.558 1.167c2.73-1.57 6.096-1.566 8.835.013l33.124 19.096c2.75 1.586 4.45 4.518 4.45 7.686l.028 38.146c.002 3.154-1.677 6.063-4.406 7.634L46.445 92.818c-2.73 1.57-6.096 1.566-8.834-.013z" />
                    <g class="book-shelf__book book-shelf__book--one" fill-rule="evenodd">
                        <path fill="#5199fc"
                              d="M31 29h4c1.105 0 2 .895 2 2v29c0 1.105-.895 2-2 2h-4c-1.105 0-2-.895-2-2V31c0-1.105.895-2 2-2z" />
                        <path fill="#afd7fb"
                              d="M34 36h-2c-.552 0-1-.448-1-1s.448-1 1-1h2c.552 0 1 .448 1 1s-.448 1-1 1zm-2 1h2c.552 0 1 .448 1 1s-.448 1-1 1h-2c-.552 0-1-.448-1-1s.448-1 1-1z" />
                    </g>
                    <g class="book-shelf__book book-shelf__book--two" fill-rule="evenodd">
                        <path fill="#ff9868"
                              d="M39 34h6c1.105 0 2 .895 2 2v24c0 1.105-.895 2-2 2h-6c-1.105 0-2-.895-2-2V36c0-1.105.895-2 2-2z" />
                        <path fill="#d06061" d="M42 38c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2z" />
                    </g>
                    <g class="book-shelf__book book-shelf__book--three" fill-rule="evenodd">
                        <path fill="#ff5068"
                              d="M49 32h2c1.105 0 2 .86 2 1.92v25.906c0 1.06-.895 1.92-2 1.92h-2c-1.105 0-2-.86-2-1.92V33.92c0-1.06.895-1.92 2-1.92z" />
                        <path fill="#d93368"
                              d="M50 35c.552 0 1 .448 1 1v2c0 .552-.448 1-1 1s-1-.448-1-1v-2c0-.552.448-1 1-1z" />
                    </g>
                    <g fill-rule="evenodd">
                        <path class="book-shelf__shelf" fill="#ae8280"
                              d="M21 60h40c1.105 0 2 .895 2 2s-.895 2-2 2H21c-1.105 0-2-.895-2-2s.895-2 2-2z" />
                        <path fill="#855f6d"
                              d="M51.5 67c-.828 0-1.5-.672-1.5-1.5V64h3v1.5c0 .828-.672 1.5-1.5 1.5zm-21 0c-.828 0-1.5-.672-1.5-1.5V64h3v1.5c0 .828-.672 1.5-1.5 1.5z" />
                    </g>
                </svg>
                <h4><span>@layoutService.GetSettingData().WebName</span><span></span></h4>
            </a>

            <form action="" class="search-form">
                <input type="search" name="" placeholder="search here..." id="search-box">
                <label for="search-box" class="fas fa-search"></label>
            </form>

            <div class="icons">
                <div id="search-btn" class="fas fa-search"></div>
                <a href="#" class="fas fa-heart"></a>
                <a href="#" class="fas fa-shopping-cart basket" onclick="openNav()">
                    <span class="count">
                        @if (User.Identity.IsAuthenticated)
                        {
                            @basket.Count
                        }
                        else
                        {
                            @basket.Count
                        }

                    </span>
                </a>
                <a href=""><i class="fas fa-user"></i></a>

                <a href=""><i class="fas fa-user-plus"></i></a>
            </div>

        </div>


        <div class="header-2">
            <nav class="navbars">
                <a asp-controller="home" asp-action="index">home</a>
                <a asp-controller="book" asp-action="index">books</a>
                <a asp-controller="author" asp-action="index">authors</a>
                <a asp-controller="blog" asp-action="index">blogs</a>
                <a asp-controller="contact" asp-action="index">Contact</a>

            </nav>
        </div>

    </header>
    <div id="mySidenav" class="bags sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>

        <div class="bag">
            @if (User.Identity.IsAuthenticated)
            {
                @if (basket.Count == 0)
                {
                    <div class="empty" style="background-image: url(../Assets/images/empty_cart.gif);background-repeat: no-repeat;width:100%;height:100%;background-position:center;">
                    </div>
                }
                else
                {

                    @await Html.PartialAsync("_basketPartial",layoutService)

                }
            }
            else
            {
                @if (basket.Count == 0)
                {
                    <div class="empty" style="background-image: url(../Assets/images/empty_cart.gif);background-repeat: no-repeat;width:100%;height:100%;background-position:center;">
                    </div>
                }
                else
                {

                    @await Html.PartialAsync("_basketPartial",layoutService)

                }
            }
        </div>
        <div class="view-cart-checkout">
            <div class="total-price">
                <h5>Total Price</h5>

                @if (User.Identity.IsAuthenticated)
                {
                    @if (basket.Count == 0)
                    {
                        <span>$0</span>
                    }
                    else
                    {
                        <span>$@basket.TotalPrice</span>
                    }
                }
                else
                {
                    @if (basket.Count == 0)
                    {
                        <span>$0</span>
                    }
                    else
                    {
                        <span>$@basket.TotalPrice</span>
                    }
                }

            </div>
            <div class="view-check">
                <button class="view" type="submit">View Cart</button>
                <button class="check" type="submit">Checkout</button>
            </div>
        </div>
    </div>

    <!-- header section ends -->
    <!-- bottom navbar  -->
    <nav class="bottom-navbar">
        <a asp-controller="home" asp-action="index" class="fas fa-home"></a>
        <a asp-controller="book" asp-action="index" class="fas fa-book"></a>
        <a asp-controller="author" asp-action="index" class="fas fa-feather-alt"></a>
        <a asp-controller="blog" asp-action="index" class="fas fa-blog"></a>
        <a asp-controller="contact" asp-action="index" class="far fa-address-book"></a>

    </nav>
    <main role="main" class="pb-3">
        @RenderBody()
    </main>
    <!-- footer section starts  -->

    <section class="footer">

        <div class="box-container">

            <div class="box">
                <h3>our locations</h3>
                <a href="#"> <i class="fas fa-map-marker-alt"></i> baku </a>
                <a href="#"> <i class="fas fa-map-marker-alt"></i> sumgait </a>
                <a href="#"> <i class="fas fa-map-marker-alt"></i> İsmaily </a>
                <a href="#"> <i class="fas fa-map-marker-alt"></i> ganca </a>

            </div>

            <div class="box">
                <h3>quick links</h3>
                <a href="#"> <i class="fas fa-arrow-right"></i> home </a>
                <a href="#"> <i class="fas fa-arrow-right"></i> books </a>
                <a href="#"> <i class="fas fa-arrow-right"></i> authors </a>
                <a href="#"> <i class="fas fa-arrow-right"></i> blogs </a>
                <a href="#"> <i class="fas fa-arrow-right"></i> contact </a>
            </div>



            <div class="box">
                <h3>contact info</h3>
                <a href="#"> <i class="fas fa-phone"></i> @layoutService.GetSettingData().PhoneNumber1 </a>
                <a href="#"> <i class="fas fa-phone"></i> @layoutService.GetSettingData().PhoneNumber2 </a>
                <a href="#"> <i class="fas fa-envelope"></i> @layoutService.GetSettingData().Email </a>
                <img src="~/Assets/images/worldmap.png" class="map" alt="">
            </div>

        </div>

        <div class="share">
            @foreach (FooterSocialMedia social in layoutService.GetSettingData().FooterSocialMedias)
            {
                <a href="@social.Url" class="@social.Icon"></a>
            }


        </div>

        <div class="credit"> created by <span>mr. Hasan Nuruzade</span> | all rights reserved! </div>

    </section>

    <!-- back to top -->
    <a href="javascript:void(0);" id="rocketmeluncur" class="showrocket"><i></i></a>

    <!-- loader  -->

    <div class="loader-container">
        <img src="~/Assets/images/loader-img.gif" alt="">
    </div>

    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="~/Assets/owl.carousel.min.js"></script>


    @RenderSection("Scripts",required:false)
    <!-- custom js file link  -->
    <script src="~/Assets/js/script.js"></script>

    <script>
        $(document).ready(function(){
          $(document).on("click",".addToCart",function(e){
              e.preventDefault();
              var href = $(this).attr("href");
              console.log(href)
              var base = window.location.origin;
              var url = `${base}${href}`
              var urlForPartial = `${base}/Book/GetPartial`

              fetch(url).then(res=>res.text()).then(data=>{

                  fetch(urlForPartial).then(res=>res.text()).then(data=>{

                  $(".bag").empty();
                  $(".bag").append(data);
                  })
                  console.log(data)

              })
          })

          $(document).on("click",".remove",function(e){

               e.preventDefault();
              var href = $(this).attr("href");
              console.log(href)
              var base = window.location.origin;
              var url = `${base}${href}`
              var urlForPartial = `${base}/Book/GetPartial`

              fetch(url).then(res=>res.text()).then(data=>{

                  fetch(urlForPartial).then(res=>res.text()).then(data=>{

                  $(".bag").empty();
                  $(".bag").append(data);
                  })
                  console.log(data)

              })
          })
        })
    </script>


</body>

</html>

